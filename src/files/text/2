На краю леса перед мельницей мельник Фаддей строгает доску для починки мельницы, повреждённой ветром. Он рассуждает о суевериях людей, убеждённых, что без колдуна ни одна мельница стоять не может. Но ведь сам-то он родился и вырос на мельнице и ни одного домового в глаза не видел. Уж если что и следует считать за колдовство, то это плутовство и обман. Появившийся Филимон — жених Анюты, дочери крестьянина Анкудина, просит мельника поворожить по поводу пропавших коней. Мельник, предчувствуя поживу, обещает исполнить просьбу, однако требует оплату вперёд. После продолжительного торга мельник соглашается ворожить и велит Филимону три раза повернуться по солнцу, затем один раз против солнца и подойти к дереву. В заключение мельник завязывает Филимону глаза платком и приказывает дожидаться его возвращения, не отвечая ни на чьи вопросы. Он очерчивает вокруг Филимона круг мелом и отходит. Струхнувший Филимон подбадривает себя песней. Мельник выносит жернова и, вращая их для создания шума, произносит заклинания. Филимон пугается ещё больше и, дрожа, хватается за дерево. Мельник некоторое время зловещим тоном произносит заклинания, после чего развязывает глаза Филимону и успокаивает его. На вопрос Филимона о конях несколько раз намекает на оплату и, получив деньги, огорчает того тем, что кони не вернутся. Продолжение после рекламы: Глядя на ладонь Филимона, мельник, давно почувствовавший его душевное состояние, говорит о кручине, изводящей того, и велит всё рассказать не таясь. Филимон рассказывает о своём желании жениться на Анюте, которому препятствует её мать — «дворянское отродье», по словам Филимона. И если отец Анюты — крестьянин и хочет иметь зятя-хлебопашца, то мать — дворянского сыночка. Мельник обещает уладить дело, за что ему обещано «четверть доброй ржи». Мельник и Филимон, довольные друг другом, отправляются в кабак отметить договор. К выходящей с крестьянского двора Анюте подходит Филимон. Анюта, опасаясь родителей и смущаясь, делает попытку уйти, но желание остаться пересиливает, и она останавливается. Филимон, видя её нерешительность, сердится и упрекает её за это, говоря, что есть и краше её и он не будет за ней гоняться. Анюта, которой Филимон нравится, медленно подходит к нему и заводит разговор. На вопрос Филимона, почему она не приходит на посиделки, Анюта жалуется на мать, которая её не отпускает из дому. Филимон её успокаивает и обещает, что скоро они поженятся. Появившийся подвыпивший мельник вызывает досаду у Анюты, так как мешает их объяснению с Филимоном. Филимон, наоборот, обнадёживает её тем, что при помощи мельника они смогут сыграть свадьбу. Показавшаяся вдали мать Анюты — Фетинья заставляет мельника и Филимона спрятаться от неё за крестьянский двор. Фетинья ругает Анюту за безделье и прогоняет её на работу. Анюта упрекает мать, ведь другие девушки гуляют, а она всё за работой, однако послушно уходит. Мельник просится в дом к Фетинье. Та приглашает его и выслушивает ворожбу мельника, догадавшегося о её тайных мыслях. Мельник велит поражённой Фетинье поднести ему что-нибудь выпить и получает в подарок целую фляжку с вином. Брифли бесплатен благодаря рекламе: Для ворожбы о суженом Анюты мельник выпроваживает Фетинью, ставит Анюту спиной к месяцу, даёт ей в руки зеркало и велит смотреть на отражение месяца. Затем он незаметно делает знак Филимону выйти из тени и показаться Анюте. Анюта, видя образ Филимона, радуется предсказанию. Мельник знаками велит Филимону опять исчезнуть, а Анюте приказывает ударить по зеркалу, чтобы видение не схватило её. Появившаяся Фетинья спрашивает у Анюты, кто ей показался, та не хочет говорить и уходит к себе. Фетинья просит поворожить, какой у неё будет зять, ведь ей хочется дворянина. Мельник отправляет её пройтись по тропинке, говоря, что кого она первым встретит, тот и будет ей зятем. На тропинке Фетинья встречает Филимона и, испугавшись, бежит обратно. Мельник её успокаивает и расспрашивает о встреченном, который внешне понравился Фетинье, однако она сомневается — дворянин ли он? Мельник уверяет, что дворянин, и даже описывает, что он из «села Хлебородова, деревни Доброй-Пожни», однако имя назвать отказывается. Появившийся Анкудин погоняет лошадь и рассуждает о тяжёлой крестьянской доле. Его останавливают мельник и Филимон, и, после приветствий, мельник сватает Филимона, характеризуя того как ухватистого парня, выросшего без отца и матери. Анкудину парень понравился, и он почти согласен, только опасается, что жена его будет против, а с ней справиться без посторонней помощи он не может. Мельник обещает ему преодолеть это препятствие. У ворот дома Анкудина встречает Фетинья со словами, что она просватала дочь, на что Анкудин сообщает, что и он просватал Анюту. Оба не желают сказать за кого, ссорятся, однако каждый настаивает на своём выборе: Анкудин — за крестьянина, а Фетинья — за дворянина Фетинья, сидящая среди работающих девушек, рассказывает Анюте о том, что они пели для неё свадебные песни. На вопрос о суженом Фетинья убеждает её в своём хорошем выборе — дворянин из села Хлебородово. Подошедший Анкудин удивляется и переспрашивает, Фетинья повторяет, что жених Анюты — помещик из деревни Доброй-Пожни и сватает его Фаддей-мельник. Анкудин не верит и рассказывает о сватовстве мельника, но только крестьянина из той же деревни. Анкудин и Фетинья допрашивают мельника о его ворожбе. Тот каждого убеждает в правильности его выбора и обещает предоставить жениха, который для Анкудина — крестьянин, а для Фетиньи — дворянин. Анкудин предполагает, что мельник сватает им оборотня. Фетинья соглашается с ним. Пьяный мельник с балалайкой представляет Филимона Фетинье, Анкудину и Анюте. Каждый из них узнаёт в Филимоне человека, с которым он повстречался ранее. Кажущееся недоразумение мельник объясняет словами песни, что на Руси у нас давно «Сам помещик, сам крестьянин, / Сам холоп и сам боярин». Таких людей, объясняет мельник, называют «однодворец — и дворянин и крестьянин — всё один». Анюта уговаривает отца и мать отдать её за Филимона. Ничего не понявшие Анкудин и Фетинья по-своему довольны, каждый из них удовлетворен наполовину. Все сходятся на том, что надо играть свадьбу, и благодарят мельника. В действие вступает хор, который прославляет мельника и благословляет свадьбу. В песне каждый из присутствующих выражает своё отношение к происходившему и, обращаясь к тестю, призывает его вести всех к себе на пир.